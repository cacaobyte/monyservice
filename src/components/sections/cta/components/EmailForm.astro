---
import Button from "../../../shared/Button.astro";

export interface Props {
  className?: string;
}

const { className = "" } = Astro.props;
---

<!-- Cargar SweetAlert2 desde CDN -->
<script src="https://cdn.jsdelivr.net/npm/sweetalert2@11" defer></script>

<!-- Script para manejar el botÃ³n -->
<script type="module">
  window.addEventListener("DOMContentLoaded", () => {
    const btn = document.getElementById("whatsappButton");
    const input = document.getElementById("emailInput");

    btn.addEventListener("click", () => {
      const email = input.value.trim();
      const regex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;

      if (regex.test(email)) {
        const encodedMessage = encodeURIComponent(
          `Hello! I'm interested in your cleaning services. My email is: ${email}`
        );
        const url = `https://wa.me/17043109302?text=${encodedMessage}`;
        window.open(url, "_blank");
      } else {
          Swal.fire({
          icon: "warning",
          title: "Missing Email",
          text: "Please enter a valid email address.",
          confirmButtonText: "OK",
          confirmButtonColor: "#facc15",
          backdrop: true,
          allowOutsideClick: true,
          allowEscapeKey: true
        });
      }
    });
  });
</script>

<!-- Estructura HTML -->
<div class={`mt-10 mb-5 w-full flex max-w-md mx-auto lg:mx-0 ${className}`}>
  <div class="flex sm:flex-row flex-col gap-5 w-full">
    <div
      class="py-1 pl-6 w-full pr-1 flex gap-3 items-center text-heading-3 shadow-lg shadow-box-shadow
      border border-box-border bg-box-bg rounded-full ease-linear focus-within:bg-body focus-within:border-primary"
    >
      <span class="min-w-max pr-2 border-r border-box-border">
        <svg
          xmlns="http://www.w3.org/2000/svg"
          width="20"
          fill="none"
          viewBox="0 0 24 24"
          stroke-width="1.5"
          stroke="currentColor"
          class="w-5 h-5"
        >
          <path
            stroke-linecap="round"
            stroke-linejoin="round"
            d="M21.75 9v.906a2.25 2.25 0 01-1.183 1.981l-6.478 3.488M2.25 9v.906a2.25 2.25 0 001.183 1.981l6.478 3.488m8.839 2.51l-4.66-2.51m0 0l-1.023-.55a2.25 2.25 0 00-2.134 0l-1.022.55m0 0l-4.661 2.51m16.5 1.615a2.25 2.25 0 01-2.25 2.25h-15a2.25 2.25 0 01-2.25-2.25V8.844a2.25 2.25 0 011.183-1.98l7.5-4.04a2.25 2.25 0 012.134 0l7.5 4.04a2.25 2.25 0 011.183 1.98V19.5z"
          />
        </svg>
      </span>
      <input
        id="emailInput"
        type="email"
        placeholder="you@email.com"
        class="w-full py-3 outline-none bg-transparent"
      />
      <button
        id="whatsappButton"
        type="button"
        class="min-w-max px-4 py-2 bg-yellow-400 text-black rounded-full font-medium hover:bg-yellow-300 transition"
      >
        Get Started
      </button>
    </div>
  </div>
</div>
